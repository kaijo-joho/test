/* --- Liquid Glass Skin (iOS風) --- */
/* 依存：HTMLはそのまま。head.js が header#site-header を用意済み、sidebarは .sidebar/#sidebar を想定 */

:root{
  --accent: #225386;              /* 既存に合わせたアクセント */
  --header-h: 56px;

  /* ガラス質感のトークン（お好みで調整） */
  --glass-blur: 16px;             /* 12〜24px で調整 */
  --glass-sat: 1.25;              /* 彩度強調 */
  --glass-radius: 14px;
  --glass-shadow: 0 10px 30px rgba(0,0,0,.12);

  /* ライト/ダークのベース色 */
  --glass-bg-light: rgba(222,222,222,.65);
  --glass-bg-dark:  rgba(16,20,28,.55);
  --glass-stroke-light: rgba(255,255,255,.45);
  --glass-stroke-dark:  rgba(255,255,255,.12);
}

/* ライト/ダークに応じた選択 */
:root{
  --glass-bg: var(--glass-bg-light);
  --glass-stroke: var(--glass-stroke-light);
}
/*
@media (prefers-color-scheme: dark){
  :root{
    --glass-bg: var(--glass-bg-dark);
    --glass-stroke: var(--glass-stroke-dark);
  }
}*/



/* ========================= */
/* Headerbar: iOS風ガラス    */
/* ========================= */
/*header#site-header{
  /*position: sticky; top: 0; z-index: 1000;*/
  /*height: var(--header-h);*//*
  background: var(--glass-bg);
  border-bottom: 1px solid var(--glass-stroke);
  box-shadow: var(--glass-shadow);
  -webkit-backdrop-filter: saturate(var(--glass-sat)) blur(var(--glass-blur));
          backdrop-filter: saturate(var(--glass-sat)) blur(var(--glass-blur));
  padding-top: env(safe-area-inset-top);
}*/

/* うっすらハイライト（液体の“縁”っぽさ） */
/*header#site-header{ position: sticky; }*//*
header#site-header::before{
  content:""; position:absolute; inset:0; pointer-events:none;
  background: linear-gradient(180deg, rgba(255,255,255,.18), transparent 60%);
}*/

/* navレイアウト（float撤去→flex一本化） */
header#site-header nav{
  height: 100%;
  /*display:flex;*/ align-items:center; justify-content:space-between;
  gap: clamp(6px,1vw,14px);
  padding: 0 clamp(10px,2vw,24px);
  z-index: 9999;
}
header#site-header nav ul{
  margin:0; padding:0; list-style:none;
  /*display:flex;*/ align-items:center; gap: clamp(6px,1vw,12px);
}
header#site-header nav li{ margin:0; float: none !important; }
header#site-header nav a{
  position: relative;
  /*display:inline-flex; align-items:center;*/
  /*height: calc(var(--header-h) - 12px);*/
  padding: 0 10px;
  color: inherit; text-decoration: none; border-radius: 10px;
}
header#site-header nav a:hover{
  background: rgba(0,0,0,.06);
}
@media (prefers-color-scheme: dark){
  header#site-header nav a:hover{ background: rgba(255,255,255,.08); }
}

/* 現在地（class/aria両対応） */
header#site-header nav a.is-active,
header#site-header nav a[aria-current="page"],
header#site-header nav .current > a{
  color: var(--accent);
}
header#site-header nav a.is-active::after,
header#site-header nav a[aria-current="page"]::after,
header#site-header nav .current > a::after{
  content:""; position:absolute; left:10px; right:10px; bottom:6px; height:2px;
  background: var(--accent); border-radius: 1px;
}

/* ========================= */
/* Sidebar: ガラスカード     */
/* ========================= */
aside.sidebar, nav.sidebar, #sidebar{
  background: var(--glass-bg);
  border: 1px solid var(--glass-stroke);
  border-top-left-radius: var(--glass-radius);
  border-bottom-left-radius: var(--glass-radius);
  box-shadow: var(--glass-shadow);
  -webkit-backdrop-filter: saturate(var(--glass-sat)) blur(var(--glass-blur));
          backdrop-filter: saturate(var(--glass-sat)) blur(var(--glass-blur));
  padding: 6px;
}
aside.sidebar h2, nav.sidebar h2, #sidebar h2{
  margin: 0 0 8px; font-size: 1.05rem; font-weight: 700;
}
aside.sidebar ul, nav.sidebar ul, #sidebar ul{
  list-style:none; margin:0; padding:0; /*display:grid; gap: 6px;*/
}
aside.sidebar li, nav.sidebar li, #sidebar li{ margin:0; }
aside.sidebar a, nav.sidebar a, #sidebar a{
  /*display:block;*/ padding:8px 10px; border-radius: 8px; color: inherit; text-decoration: none;
}
aside.sidebar a:hover, nav.sidebar a:hover, #sidebar a:hover{
  background: rgba(0,0,0,.05);
}
@media (prefers-color-scheme: dark){
  aside.sidebar a:hover, nav.sidebar a:hover, #sidebar a:hover{
    background: rgba(255,255,255,.06);
  }
}
/* 現在地強調 */
aside.sidebar a.is-active,
aside.sidebar a[aria-current="page"],
aside.sidebar .current > a,
nav.sidebar a.is-active,
nav.sidebar a[aria-current="page"],
nav.sidebar .current > a,
#sidebar a.is-active,
#sidebar a[aria-current="page"],
#sidebar .current > a{
  color: var(--accent);
  background: rgba(34,83,134,.10); /* アクセントの薄いベール */
  font-weight: 600;
}

/* ========================= */
/* （任意）Articleもガラス化 */
/* ========================= */
/* 既存のskin-card.cssを使っていない場合だけ有効化してください */
article{
  background: var(--glass-bg);
  border: 1px solid var(--glass-stroke);
  border-radius: 14px;
  box-shadow: var(--glass-shadow);
  -webkit-backdrop-filter: saturate(var(--glass-sat)) blur(calc(var(--glass-blur) * .75));
          backdrop-filter: saturate(var(--glass-sat)) blur(calc(var(--glass-blur) * .75));
  padding: clamp(12px, 1.2vw + 8px, 20px);
  margin-block: clamp(12px, 1.2vw + 6px, 20px);
}
article > h2{
  margin: calc(clamp(12px, 1.2vw + 8px, 20px) * -1)
          calc(clamp(12px, 1.2vw + 8px, 20px) * -1) .8rem;
  padding: .7rem .9rem;
  display:flex; align-items:center;
  line-height:1.35; white-space:normal;
  border-bottom: 1px solid var(--glass-stroke);
  border-top-left-radius: 12px; border-top-right-radius:12px;
  background: linear-gradient(180deg, rgba(255,255,255,.12), transparent 70%);
}

/* ========================= */
/* アクセシビリティ＆微調整  */
/* ========================= */

/* 見出しアンカーが隠れない（固定ヘッダー対策） */
/*html { scroll-padding-top: calc(var(--header-h) + 8px); }
:target{ scroll-margin-top: calc(var(--header-h) + 8px); }*/

/* フォーカスリング */
header#site-header a:focus-visible,
aside.sidebar a:focus-visible, nav.sidebar a:focus-visible, #sidebar a:focus-visible{
  outline: 2px solid color-mix(in srgb, var(--accent) 60%, #000);
  outline-offset: 2px; border-radius: 10px;
}

/* モーションを抑制（教室の大画面で酔い対策） */
@media (prefers-reduced-motion: reduce){
  *{ transition: none !important; animation: none !important; }
}

/* backdrop-filter 非対応ブラウザのフォールバック（より不透明に） */
@supports not ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))) {
  header#site-header,
  aside.sidebar, nav.sidebar, #sidebar,
  article{
    background: rgba(255,255,255,.95);
    box-shadow: 0 8px 24px rgba(0,0,0,.1);
  }
  @media (prefers-color-scheme: dark){
    header#site-header,
    aside.sidebar, nav.sidebar, #sidebar,
    article{ background: rgba(16,20,28,.9); }
  }
}



/* ===== Sidebar: Glass（オフキャンバス機構は維持） ===== */

/* コンテナは “従来どおり” オフキャンバス。ここは上書きしないのが正解 */
#sidebar{
  position: fixed; top: 0; right: -240px;   /* ← 既存sidebar.cssの意図を踏襲 */
  width: 280px; height: 100vh;
  display: flex;
  z-index: 1100;
  transition: right .35s ease;              /* スライドのアニメーション */
  background: transparent; border: 0; box-shadow: none; /* コンテナ自体は透明 */
}
#check:checked ~ #sidebar{ right: 0; }       /* ← 開いた状態（既存の動作を復活） */

/* ガラス質感は “中身（パネル）” に付与 */
#sidebar_right{
  background: var(--glass-bg);
  border: 1px solid var(--glass-stroke);
  border-left: 0;
  border-top-left-radius: 14px;
  border-bottom-left-radius: 14px;
  box-shadow: var(--glass-shadow);
  -webkit-backdrop-filter: saturate(var(--glass-sat)) blur(var(--glass-blur));
          backdrop-filter: saturate(var(--glass-sat)) blur(var(--glass-blur));
  padding: 12px;
  overflow: auto;
}

/* ハンドル（ハンバーガーのボタン側）も軽くガラス化 */
#sidebar_left{ background: transparent; }
#sidebar_left label #closeBtn{
  background: var(--glass-bg);
  border: 1px solid var(--glass-stroke);
  border-right: 0;
  border-top-left-radius: 14px;
  border-bottom-left-radius: 14px;
  box-shadow: var(--glass-shadow);
  -webkit-backdrop-filter: saturate(var(--glass-sat)) blur(var(--glass-blur));
          backdrop-filter: saturate(var(--glass-sat)) blur(var(--glass-blur));
}

/* ===== Sidebar Handle (右端中央) ===== */
:root{
  --glass-blur: 16px;
  --glass-sat: 1.25;
  --glass-shadow: 0 10px 30px rgba(0,0,0,.12);
  --glass-bg: rgba(255,255,255,.65);
  --glass-stroke: rgba(255,255,255,.45);
  --accent: #225386;
}

@media (prefers-color-scheme: dark){
  :root{
    --glass-bg: rgba(16,20,28,.55);
    --glass-stroke: rgba(255,255,255,.12);
  }
}

/* ハンドル本体：右端中央に貼り付け */
#sidebar-handle{
  position: fixed;
  top: 50%;
  right: env(safe-area-inset-right, 0px);
  transform: translateY(-50%);
  z-index: 1200;
  width: 18px;
  height: 72px;
  border-radius: 10px 0 0 10px;
  cursor: pointer;

  /*background: var(--glass-bg);*/
  border: 1px solid var(--glass-stroke);
  border-right: none;
  box-shadow: var(--glass-shadow);
  -webkit-backdrop-filter: saturate(var(--glass-sat)) blur(var(--glass-blur));
          backdrop-filter: saturate(var(--glass-sat)) blur(var(--glass-blur));

  display: flex; align-items: center; justify-content: center;
  transition: transform .22s ease, opacity .18s ease;
}

/* “縦線のアイコン” */
#sidebar-handle::before{
  content:"";
  width: 2px; height: 60%;
  background: color-mix(in srgb, var(--accent) 85%, transparent);
  border-radius: 1px;
}

/* ホバーで少し左へ（iOS等pointer:coarseでは実質無視されてもOK） */
#sidebar-handle:hover{
  transform: translate(-6px, -50%);
}

/* サイドバー展開時はハンドルを隠す（クリック先が被らないように） */
#check:checked ~ #sidebar-handle{
  opacity: 0; pointer-events: none;
}

/* モバイルは少し小さく */
@media (max-width: 840px){
  #sidebar-handle{ width: 16px; height: 56px; }
}











/* 右端から20px内側に固定（iOS安全域にも対応） */
#sidebar-handle{
  position: fixed;
  top: 50%;
  right: 20px;                                /* まずは素直に 20px */
  right: calc(20px + env(safe-area-inset-right)); /* Safari等で安全域がある場合は+α */
  transform: translateY(-50%);
  z-index: 1200;

  width: 18px;
  height: 72px;
  border-radius: 10px 0 0 10px;
  cursor: pointer;

  background: var(--glass-bg);
  border: 1px solid var(--glass-stroke);
  border-right: none;
  box-shadow: var(--glass-shadow);
  -webkit-backdrop-filter: saturate(var(--glass-sat)) blur(var(--glass-blur));
          backdrop-filter: saturate(var(--glass-sat)) blur(var(--glass-blur));

  display: flex; align-items: center; justify-content: center;
  transition: transform .22s ease, opacity .18s ease;
}

/* 縦線アイコン（そのまま） */
#sidebar-handle::before{
  content:"";
  width: 2px; height: 60%;
  background: color-mix(in srgb, var(--accent) 85%, transparent);
  border-radius: 1px;
}

/* ホバー時に少し左へズレる（デスクトップ向け） */
#sidebar-handle:hover{
  transform: translate(-6px, -50%);           /* ← 横方向に -6px だけ追加移動 */
}

/* キーボード操作でも分かるように（任意） */
#sidebar-handle:focus-visible{
  outline: 2px solid color-mix(in srgb, var(--accent) 60%, #000);
  outline-offset: 2px;
  transform: translate(-6px, -50%);
}

/* サイドバー展開中はハンドルを隠す（既存のトグルを利用） */
#check:checked ~ #sidebar-handle{
  opacity: 0; pointer-events: none;
}

/* モバイルは少し小さく（必要なら） */
@media (max-width: 840px){
  #sidebar-handle{ width: 16px; height: 56px; }
}